---
import { Sun, Moon } from 'lucide-react'
---

<button
  id="theme-toggle"
  class="rounded-lg border-2 border-white/20 dark:border-white/20 bg-white/5 dark:bg-white/5 p-2 text-white dark:text-white transition-all hover:bg-white/10 dark:hover:bg-white/10"
  aria-label="Toggle theme"
>
  <Sun className="h-5 w-5 block dark:hidden" id="sun-icon" />
  <Moon className="h-5 w-5 hidden dark:block" id="moon-icon" />
</button>

<script>
  function initThemeToggle() {
    const handleToggleClick = () => {
      const element = document.documentElement;
      element.classList.toggle('dark');

      const isDark = element.classList.contains('dark');
      localStorage.setItem('theme', isDark ? 'dark' : 'light');
    };

    const button = document.getElementById('theme-toggle');
    if (button) {
      button.addEventListener('click', handleToggleClick);
    }
  }

  // Initialize on load
  initThemeToggle();
  
  // Re-initialize after navigation (View Transitions)
  document.addEventListener('astro:page-load', initThemeToggle);
</script>
